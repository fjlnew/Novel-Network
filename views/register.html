<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>登录</title>
    <link rel="icon" href="../public/img/logo_head.png" type="image/x-icon" />
    <link rel="stylesheet" href="../public/css/register.css">
</head>

<body>
    <div class="wrap">
        <!-- 头部 -->
        <div class="header">
            <div class="box-center">
                <div class="logo cf">
                    <a href="#"></a>
                    <em></em>
                    <span class="lang">用户注册</span>
                </div>
            </div>
        </div>

        <div class="box-center">
            <div class="reg-wrap">
                <div class="reg-step">
                    <span class="lang act">
                        <i>1</i>填写注册信息
                    </span>
                    <span class="lang">
                        <i>2</i>注册成功
                    </span>
                </div>
                <div class="reg-form-wrap">
                    <form class="" action>
                        <div class="reg-form-list form-list">
                            <dl>
                                <dd class="phone top cf" id="phone">
                                    <em>手机号:</em>
                                    <input type="text" placeholder="请输入手机号码" onchange="phonechange(this)">
                                    <i class="sprite icon-error disnone"></i>
                                    <p class="error-tip disnone">请输入正确的手机号码</p>
                                </dd>
                                <dd class="phonecode">
                                    <em>验证码:</em>
                                    <input type="text" class="mid" placeholder="请输入验证码" onchange="codechange(this)">
                                    <a href="#">获取验证码</a>
                                    <i class="sprite icon-error disnone"></i>
                                    <p class="error-tip disnone">验证码不正确</p>
                                </dd>
                                <dd class="phonewd">
                                    <em>密码:</em>
                                    <input type="password" placeholder="请输入密码" onchange="passworldchange(this)">
                                    <i class="sprite icon-error disnone"></i>
                                    <p class="error-tip disnone">密码为6~14位</p>
                                </dd>
                                <dd class="phonewd2">
                                    <em>确认密码:</em>
                                    <input type="password" placeholder="确认密码" onchange="repasswrdchange(this)">
                                    <i class="sprite icon-error disnone"></i>
                                    <p class="error-tip disnone">密码不一致</p>
                                </dd>
                            </dl>
                            <div class="deal">
                                <input type="checkbox" id="deal">
                                <label for="deal">我已经阅读并同意</label>
                                <a href="#">《用户服务协议》</a>
                                <label>和</label>
                                <a href="#">《隐私政策》</a>
                            </div>
                            <a class="btn-qidian" onclick="register()">立即注册</a>
                        </div>
                    </form>
                    <div class="reg-sucess disnone02">
                        <div class="successbox">
                            <b>注册成功！</b><br>
                            <a href="/centertap">返回登录</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <div class="link">
                <a href="#">关于我们</a>
                <a href="#">联系我们</a>
                <a href="#">加入我们</a>
                <a href="#">客服中心</a>
                <a href="#">提交建议</a>
                <a href="#">举报中心</a>
            </div>
            <p>Copyright (C) 2002-2019 www.qidian.com All Right Reserved版权所有 上海玄霆娱乐信息科技有限公司</p>
            <p>上海玄霆娱乐信息科技有限公司 增值电信业务经营许可证沪B2-20080046 沪网文[2012]0068-008 新出网证（沪）字010 沪ICP备08017520号-1</p>
            <p>请所有作者发布作品时务必遵守国家互联网信息管理办法规定，我们拒绝任何色情小说，一经发现，即作删除！客服电话：010-59357051</p>
            <p>本站所收录作品、社区话题、书库评论及本站所做之广告均属个人行为，与本站立场无关</p>
            <div class="safety-box">
                <div class="safety-img dib-wrap">
                    <a class="site1" href=""></a>
                    <a class="site2" href=""></a>
                    <a class="site3" href=""></a>
                    <a class="site4" href=""></a>
                    <a class="site5" href=""></a>
                    <a class="site6" href=""></a>
                    <a class="site7" href=""></a>
                </div>
            </div>
        </div>

        <form id="editform" action="postServlet2" method="post">
        </form>

    </div>


    <script src="../public/js/jquery.js"></script>
    <script>
        var i = 0,
            j = 0,
            k = 0,
            l = 0;
        var userphone = '';
        var userpassworld = '';

        function phonechange(e) {
            var phonei = document.querySelector('.phone i');
            var phonep = document.querySelector('.phone p');
            var reg = /^[1-9]\d*$|^0$/;
            if (e.value.length == 11 && e.value[0] == 1 && reg.test(e.value)) {
                phonei.classList.add('disnone');
                phonep.classList.add('disnone');
                userphone = e.value;
                i = 1;
            } else {
                phonei.classList.remove('disnone');
                phonep.classList.remove('disnone');
                i = 0;
            }
        }

        function codechange(e) {
            var phonecodei = document.querySelector('.phonecode i');
            var phonecodep = document.querySelector('.phonecode p');
            if (e.value.length == 6) {
                phonecodei.classList.add('disnone');
                phonecodep.classList.add('disnone');
                j = 1;
            } else {
                phonecodei.classList.remove('disnone');
                phonecodep.classList.remove('disnone');
                j = 0;
            }
        }

        function passworldchange(e) {
            var phonewdi = document.querySelector('.phonewd i');
            var phonewdp = document.querySelector('.phonewd p');
            if (e.value.length >= 6) {
                phonewdi.classList.add('disnone');
                phonewdp.classList.add('disnone');
                userpassworld = e.value;
                k = 1;
            } else {
                phonewdi.classList.remove('disnone');
                phonewdp.classList.remove('disnone');
                k = 0;
            }
        }

        function repasswrdchange(e) {
            var passworld = document.querySelector('.phonewd input').value;
            var phonewd2i = document.querySelector('.phonewd2 i');
            var phonewd2p = document.querySelector('.phonewd2 p');
            if (e.value == passworld) {
                phonewd2i.classList.add('disnone');
                phonewd2p.classList.add('disnone');
                l = 1;
            } else {
                phonewd2i.classList.remove('disnone');
                phonewd2p.classList.remove('disnone');
                l = 0;
            }
        }

        function register() {
            var dealcheckbox = document.querySelector('.deal input').checked;
            if (i == 1 && j == 1 && k == 1 && l == 1 && dealcheckbox) {
                var mydata = $.param({
                    "userphone": userphone
                }) + "&" + $.param({
                    "userpassworld": userpassworld
                }) + "&" + $("#editform").serialize() + "";
                $.ajax({
                    url: '/register',
                    type: 'post',
                    data: mydata,
                    success: function (data) {
                        if (data.isok == 1) {
                            registesesser();
                        } else {

                        }
                    }
                })
            } else {}
        }

        function registesesser() {
            var tapchanges = document.querySelectorAll('.reg-step span');
            tapchanges[0].classList.remove('act');
            tapchanges[1].classList.add('act');
            var formbox = document.querySelector('.reg-form-wrap form');
            var regsucess = document.querySelector('.reg-sucess');
            formbox.classList.add('disnone02')
            regsucess.classList.remove('disnone02')
        }
    </script>
</body>

</html>